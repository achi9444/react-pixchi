import{r as c,j as s}from"./index-CfJp-xQk.js";const r=25;function L(){const[o,S]=c.useState(16),[h,u]=c.useState(Array(16).fill(null).map(()=>Array(16).fill("#ffffff"))),[f,v]=c.useState("#ff6b6b"),[p,i]=c.useState(!1),[C,x]=c.useState(!1),[m,E]=c.useState(!0),w=c.useRef(null),j=t=>Array(t).fill(null).map(()=>Array(t).fill("#ffffff")),d=(t,e)=>{t<0||e<0||t>=o||e>=o||u(n=>{const a=n.map(l=>[...l]);return a[t][e]=C?"#ffffff":f,a})},N=(t,e)=>{i(!0),d(t,e)},b=(t,e)=>{p&&d(t,e)},k=()=>i(!1),G=(t,e,n)=>{t.preventDefault(),i(!0),d(e,n)},y=t=>{t.preventDefault();const e=t.touches[0],n=document.elementFromPoint(e.clientX,e.clientY);if(n&&n.dataset.row&&n.dataset.col){const a=parseInt(n.dataset.row,10),l=parseInt(n.dataset.col,10);p&&d(a,l)}},M=()=>i(!1),D=()=>u(j(o)),T=()=>{const t=document.createElement("canvas");t.width=o*r,t.height=o*r;const e=t.getContext("2d");h.forEach((a,l)=>a.forEach((R,g)=>{e.fillStyle=R,e.fillRect(g*r,l*r,r,r),m&&(e.strokeStyle="#ccc",e.strokeRect(g*r,l*r,r,r))}));const n=document.createElement("a");n.download=`perler-${o}x${o}.png`,n.href=t.toDataURL(),n.click()},I=t=>{const e=parseInt(t.target.value,10);!isNaN(e)&&e>0&&e<=64&&(S(e),u(j(e)))};return s.jsxs("div",{className:"perler-container",onMouseUp:k,onTouchEnd:M,onTouchMove:y,children:[s.jsxs("div",{className:"perler-tools",children:[s.jsx("input",{type:"color",value:f,onChange:t=>v(t.target.value)}),s.jsx("button",{onClick:()=>x(!1),children:"畫筆"}),s.jsx("button",{onClick:()=>x(!0),children:"橡皮擦"}),s.jsx("button",{onClick:D,children:"清空"}),s.jsx("button",{onClick:T,children:"匯出 PNG"}),s.jsxs("label",{children:["格數：",s.jsx("input",{type:"number",min:"4",max:"64",value:o,onChange:I})]}),s.jsxs("label",{children:[s.jsx("input",{type:"checkbox",checked:m,onChange:t=>E(t.target.checked)}),"匯出時顯示格線"]})]}),s.jsx("div",{className:"perler-grid",ref:w,children:h.map((t,e)=>s.jsx("div",{className:"perler-row",children:t.map((n,a)=>s.jsx("div",{className:"perler-cell",style:{backgroundColor:n,width:r,height:r},"data-row":e,"data-col":a,onMouseDown:()=>N(e,a),onMouseEnter:()=>b(e,a),onTouchStart:l=>G(l,e,a)},a))},e))})]})}const A=()=>s.jsx(s.Fragment,{children:s.jsxs("main",{className:"classMain",children:[s.jsxs("header",{className:"perler-header",children:[s.jsx("h2",{children:"拼豆模擬器"}),s.jsxs("p",{children:["歡迎使用拼豆模擬器！你可以自訂格數、選擇顏色、使用畫筆或橡皮擦進行創作。",s.jsx("br",{}),"完成後還能匯出 PNG 圖片，並選擇是否顯示格線。"]})]}),s.jsx("section",{className:"perler-main",children:s.jsx(L,{})})]})});export{A as default};
