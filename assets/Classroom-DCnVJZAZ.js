import{r as l,j as n}from"./index-BliX3vDB.js";const h=25;function A(){const[r,v]=l.useState(16),[f,d]=l.useState(Array(16).fill(null).map(()=>Array(16).fill("#ffffff"))),[p,C]=l.useState("#ff6b6b"),[x,c]=l.useState(!1),[E,m]=l.useState(!1),[u,b]=l.useState(!0),w=l.useRef(null),j=t=>Array(t).fill(null).map(()=>Array(t).fill("#ffffff")),i=(t,e)=>{t<0||e<0||t>=r||e>=r||d(s=>{const o=s.map(a=>[...a]);return o[t][e]=E?"#ffffff":p,o})},N=(t,e)=>{c(!0),i(t,e)},k=(t,e)=>{x&&i(t,e)},G=()=>c(!1),y=(t,e,s)=>{t.preventDefault(),c(!0),i(e,s)},M=t=>{t.preventDefault();const e=t.touches[0],s=document.elementFromPoint(e.clientX,e.clientY);if(s&&s.dataset.row&&s.dataset.col){const o=parseInt(s.dataset.row,10),a=parseInt(s.dataset.col,10);x&&i(o,a)}},D=()=>c(!1),T=()=>d(j(r)),I=()=>{const t=document.createElement("canvas"),e=h;t.width=r*e,t.height=r*e;const s=t.getContext("2d");f.forEach((a,g)=>a.forEach((R,S)=>{s.fillStyle=R,s.fillRect(S*e,g*e,e,e),u&&(s.strokeStyle="#ccc",s.strokeRect(S*e,g*e,e,e))}));const o=document.createElement("a");o.download=`perler-${r}x${r}.png`,o.href=t.toDataURL(),o.click()},L=t=>{const e=parseInt(t.target.value,10);!isNaN(e)&&e>0&&e<=64&&(v(e),d(j(e)))};return n.jsxs("div",{className:"perler-container",ref:w,onMouseUp:G,onTouchEnd:D,onTouchMove:M,children:[n.jsxs("div",{className:"perler-tools",children:[n.jsx("input",{type:"color",value:p,onChange:t=>C(t.target.value)}),n.jsx("button",{onClick:()=>m(!1),children:"畫筆"}),n.jsx("button",{onClick:()=>m(!0),children:"橡皮擦"}),n.jsx("button",{onClick:T,children:"清空"}),n.jsx("button",{onClick:I,children:"匯出 PNG"}),n.jsxs("label",{children:["格數：",n.jsx("input",{type:"number",min:"4",max:"64",value:r,onChange:L})]}),n.jsxs("label",{children:[n.jsx("input",{type:"checkbox",checked:u,onChange:t=>b(t.target.checked)}),"匯出時顯示格線"]})]}),n.jsx("div",{className:"perler-grid",children:f.map((t,e)=>n.jsx("div",{className:"perler-row",children:t.map((s,o)=>n.jsx("div",{className:"perler-cell",style:{backgroundColor:s,width:h,height:h,border:u?"1px solid #eee":"none"},"data-row":e,"data-col":o,onMouseDown:()=>N(e,o),onMouseEnter:()=>k(e,o),onTouchStart:a=>y(a,e,o)},o))},e))})]})}const z=()=>n.jsx(n.Fragment,{children:n.jsxs("main",{className:"classMain",children:[n.jsxs("header",{className:"perler-header",children:[n.jsx("h2",{children:"拼豆模擬器"}),n.jsxs("p",{children:["歡迎使用拼豆模擬器！你可以自訂格數、選擇顏色、使用畫筆或橡皮擦進行創作。",n.jsx("br",{}),"完成後還能匯出 PNG 圖片，並選擇是否顯示格線。"]})]}),n.jsx("section",{className:"perler-main",children:n.jsx(A,{})})]})});export{z as default};
